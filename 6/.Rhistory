library(tidyr)
y <- read.csv("~/UVa/all_teaching/spring19_6440/6440_slides/6/light.txt", header=F)
n <- length(y)
s <- sd(y)
my <- mean(y)
y[,1]
y <- y[,1]
n <- length(y)
s <- sd(y)
my <- mean(y)
sampt1000 <- replicate(1000, rt(n, n-1)*sqrt(1+1/n)*s+my) %>%
as.data.frame()
minvals <- data.frame(x = sapply(sampt1000, min))
minvals
library(ggplot2)
title1 <- 'Smallest observation in the replicated
data (hist.) vs in the original data (vertical line)'
ggplot(data = minvals) +
geom_histogram(aes(x = x), fill = 'steelblue',
color = 'black', binwidth = 4) +
geom_vline(aes(xintercept = min(x)), data = data.frame(x = y),
color = 'red') +
coord_cartesian(xlim = c(-50, 20)) +
labs(x = '', y = '', title = title1) +
scale_y_continuous(breaks=NULL)
x
head(minvals)
sapply(sampt1000, min)
sapply(sampt1000, min) > min(y)
mean(sapply(sampt1000, min) > min(y))
min(y)
sapply(sampt1000, min)
dim(sapply(sampt1000, min))
length(sapply(sampt1000, min))
mean(sapply(sampt1000, min) > min(y))
