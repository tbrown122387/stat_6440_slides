\documentclass{beamer}

\mode<presentation> {

%\usetheme{default}
%\usetheme{AnnArbor}
%\usetheme{Antibes}
%\usetheme{Bergen}
%\usetheme{Berkeley}
%\usetheme{Berlin}
%\usetheme{Boadilla}
%\usetheme{CambridgeUS}
%\usetheme{Copenhagen}
%\usetheme{Darmstadt}
%\usetheme{Dresden}
%\usetheme{Frankfurt}
%\usetheme{Goettingen}
%\usetheme{Hannover}
%\usetheme{Ilmenau}
%\usetheme{JuanLesPins}
%\usetheme{Luebeck}
\usetheme{Madrid}
%\usetheme{Malmoe}
%\usetheme{Marburg}
%\usetheme{Montpellier}
%\usetheme{PaloAlto}
%\usetheme{Pittsburgh}
%\usetheme{Rochester}
%\usetheme{Singapore}
%\usetheme{Szeged}
%\usetheme{Warsaw}


%\usecolortheme{albatross}
%\usecolortheme{beaver}
%\usecolortheme{beetle}
%\usecolortheme{crane}
%\usecolortheme{dolphin}
%\usecolortheme{dove}
%\usecolortheme{fly}
%\usecolortheme{lily}
%\usecolortheme{orchid}
%\usecolortheme{rose}
%\usecolortheme{seagull}
%\usecolortheme{seahorse}
%\usecolortheme{whale}
%\usecolortheme{wolverine}

%\setbeamertemplate{footline} % To remove the footer line in all slides uncomment this line
%\setbeamertemplate{footline}[page number] % To replace the footer line in all slides with a simple slide count uncomment this line

%\setbeamertemplate{navigation symbols}{} % To remove the navigation symbols from the bottom of all slides uncomment this line
}

\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage{amsfonts}
\usepackage{mathrsfs, bbold}
\usepackage{amsmath,amssymb,graphicx}
\usepackage{mathtools} % gather
\usepackage[export]{adjustbox} % right-aligned graphics

% argmax
\DeclareMathOperator*{\argmax}{arg\,max}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title["23"]{23: Dirichlet Process Models}

\author{Taylor} 
\institute[UVA] 
{
University of Virginia \\
\medskip
\textit{} 
}
\date{} 

\begin{document}
%----------------------------------------------------------------------------------------

\begin{frame}
\titlepage 
\end{frame}

%----------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Introduction}

TODO

\end{frame}
%----------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Definitions}

A probability model for the density analagous to the histogram 
$$
f(y \mid \pi_1, \ldots, \pi_k) = \sum_{h=1}^k 1_{\xi_{h-1} < y \le \xi_{h} } \frac{\pi_h}{(\xi_{h} - \xi_{h-1})}
$$
where $\xi_0 < \xi_1 < \cdots < \xi_k$ are your {\bf knot points}, and $(\pi_1, \ldots, \pi_k)$ is an unknown probability vector. 
\newline
\pause

Note
$$
\int f(y) \text{d}y = \sum_{h=1}^k \text{base}_h \times \text{height}_h = \sum_{h=1}^k (\xi_{h} - \xi_{h-1})\frac{\pi_h}{(\xi_{h} - \xi_{h-1})} = 1.
$$

\end{frame}


%----------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Definitions}

$$
f(y \mid \pi) = \sum_{h=1}^k 1_{\xi_{h-1} < y \le \xi_{h} } \frac{\pi_h}{(\xi_{h} - \xi_{h-1})}
$$
We can put a $\text{Dirichlet}(\alpha_1, \ldots, \alpha_k)$ prior on the parameters $\pi = (\pi_1, \ldots, \pi_k)$:

$$
p(\pi ) = \frac{\Gamma\left( \sum_{h=1}^k a_h \right) }{\prod_{h=1}^k \Gamma(\alpha_h) } \prod_{h=1}^k \pi_h^{a_h-1}
$$
where $a = (a_1, \ldots, a_k)$ are the chosen parameters of the prior.

\end{frame}

%----------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Definitions}

Note that $f(y \mid \pi)$ was for one data point $y$. Let $\sigma(i) = \{k : \xi_{k-1} < y_i \le \xi_{k} \}$. Notice that this function is many-to-one. Then

\begin{align*}
p(y \mid \pi)  &= \prod_{i=1}^n f(y_i \mid \pi) \\
&= \prod_{i=1}^n\left[ \sum_{h=1}^k 1_{\xi_{h-1} < y_i \le \xi_{h} } \frac{\pi_h}{(\xi_{h} - \xi_{h-1})} \right] \\
&= \prod_{i=1}^n\left[  \frac{\pi_{\sigma(i)} }{(\xi_{\sigma(i)} - \xi_{\sigma(i)-1}  )} \right] \\
&= \prod_{h=1}^k \left[  \frac{\pi_{h} }{(\xi_{h} - \xi_{h-1}  )} \right] ^{n_h}
\end{align*}  
where $n_h = \sum_{i=1}^n 1_{\xi_{h-1} < y_i \le \xi_{h} }$.
\end{frame}

%----------------------------------------------------------------------------------------
\begin{frame}
\frametitle{Definitions}

Bayes' rule:

\begin{align*}
p(\pi \mid y) &\propto p(y \mid \pi) p(\pi) \\
&= \left[\prod_{h=1}^k   \frac{\pi_{h} }{(\xi_{h} - \xi_{h-1}  )} \right] ^{n_h}\prod_{h=1}^k \pi_h^{a_h-1} \\
&\propto \prod_{h=1}^k \pi_h^{a_h+n_h-1}
\end{align*}
So $p(\pi \mid y) = \text{Dirichlet}(a_1 + n_1, \ldots, a_k + n_k)$.
\pause
\newline

But bin specification is annoying!
\end{frame}


\end{document} 
