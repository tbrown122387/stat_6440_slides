y <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,
2,1,5,2,5,3,2,7,7,3,3,2,9,10,4,4,4,4,4,4,4,10,4,4,4,5,11,12,
5,5,6,5,6,6,6,6,16,15,15,9,4)
n <- c(20,20,20,20,20,20,20,19,19,19,19,18,18,17,20,20,20,20,19,19,18,18,25,24,
23,20,20,20,20,20,20,10,49,19,46,27,17,49,47,20,20,13,48,50,20,20,20,20,
20,20,20,48,19,19,19,22,46,49,20,20,23,19,22,20,20,20,52,46,47,24,14)
y/n
mean(y/n)
mean(y[-71]/n[-71])
n[71]+1.4
y[71]+1.4
y[71]
n[71]
?gather
y <- 2
log_un_target <- function(theta){
-(theta-y)^2/2 - log(1 + theta^2)
}
?rt
num_trials <- 1000
theta_proposals <- rt(num_trials, 1)
hist(theta_proposals)
log_accept_prob <- function(theta){
-.5*(y - theta)^2
}
log_accept_prob(theta_proposals)
hist(log_accept_prob(theta_proposals))
max(log_accept_prob(theta_proposals))
exp(lps - max(lps))
lps <- log_accept_prob(theta_proposals)
probs <- exp(lps - max(lps))
probs
exp(lps)
hist(exp(lps))
hist(exp(lps-max(lps))*exp(max(lps)))
hist(exp(lps))
hist(exp(lps-max(lps))*exp(max(lps)))
us <- runif(num_trials, min = 0, max = 1)
ifelse(us < probs, 1, 0)
theta_proposals[ifelse(us < probs, 1, 0)]
hist(theta_proposals[ifelse(us < probs, 1, 0)])
hist(theta_proposals[ifelse(us < probs, TRUE, FALSE)])
hist(theta_proposals)
hist(theta_proposals[accepts])
accepts <- ifelse(us < probs, TRUE, FALSE)
hist(theta_proposals[accepts])
y
y <- 2 # fake data
num_samples <- 1000
theta_draws <- rt(num_trials, 1)
num_samples <- 1000
theta_draws <- rt(num_samples , 1)
log_unnorm_weight <- function(theta){ # don't worry about the sqrt(2pi) because it will cancel out
-.5*(y - theta)^2
}
lunws <- log_unnorm_weight(theta_draws)
moved_lunws <- lunws - max(lunws)
norm_weights <- exp(moved_lunws)/sum(exp(moved_lunws))
bad_norm_weights <- exp(lunws)/sum(exp(lunws))
mean(norm_weights * theta_draws)
mean(bad_norm_weights * theta_draws)
y <- 2 # fake data
num_samples <- 10000
theta_draws <- rt(num_samples , 1)
log_unnorm_weight <- function(theta){ # don't worry about the sqrt(2pi) because it will cancel out
-.5*(y - theta)^2
}
lunws <- log_unnorm_weight(theta_draws)
moved_lunws <- lunws - max(lunws)
norm_weights <- exp(moved_lunws)/sum(exp(moved_lunws))
bad_norm_weights <- exp(lunws)/sum(exp(lunws))
mean(norm_weights * theta_draws)
mean(bad_norm_weights * theta_draws)
num_samples <- 100000
theta_draws <- rt(num_samples , 1)
log_unnorm_weight <- function(theta){ # don't worry about the sqrt(2pi) because it will cancel out
-.5*(y - theta)^2
}
lunws <- log_unnorm_weight(theta_draws)
moved_lunws <- lunws - max(lunws)
norm_weights <- exp(moved_lunws)/sum(exp(moved_lunws))
bad_norm_weights <- exp(lunws)/sum(exp(lunws))
mean(norm_weights * theta_draws)
mean(bad_norm_weights * theta_draws)
hist(bad_norm_weights)
hist(norm_weights)
num_samples <- 1000000
theta_draws <- rt(num_samples , 1)
log_unnorm_weight <- function(theta){ # don't worry about the sqrt(2pi) because it will cancel out
-.5*(y - theta)^2
}
lunws <- log_unnorm_weight(theta_draws)
moved_lunws <- lunws - max(lunws)
norm_weights <- exp(moved_lunws)/sum(exp(moved_lunws))
bad_norm_weights <- exp(lunws)/sum(exp(lunws))
mean(norm_weights * theta_draws)
mean(bad_norm_weights * theta_draws)
y <- 2 # fake data
num_samples <- 1000000
theta_draws <- rt(num_samples , 1)
log_unnorm_weight <- function(theta){ # don't worry about the sqrt(2pi) because it will cancel out
-.5*(y - theta)^2
}
lunws <- log_unnorm_weight(theta_draws)
norm_weights <- exp(lunws)/sum(exp(lunws))
mean(norm_weights * theta_draws)
hist(norm_weights * theta_draws)
hist(norm_weights)
